# Выборки

## трейн-валид-тест
При построении модели используются 3 выборки: 
1. трейн (train, обучающая) - для обучения параметров
2. валид (valid, валидационная) - для настройки гиперпараметров
3. тест (test, тестовая) - для оценки обобщающей способности.

При построении модели очень важно получить достоверную, надежную оценку обобщающей способности, чтобы знать, какого качества ожидать при использовании модели на проде.

## data leakage
Важно не допускать протечки одной выборки в другую (__data leakage__). <br/>
__Объяснение:__ выборка из генеральной совокупности зачастую содержит ложные (spurious) закономерности, не выполняющиеся в генеральной совокупности. Во время обучения / выбора гиперпараметров вероятно будет отдаваться предпочтение моделям, опирающимся в том числе на spurious закономерности. <br/>
__Пример spurious закономерностей:__ в датасете фотографий кошек и собак, где собак снимали на природе, а кошек в помещениях, природа/помещение будет spurious корреляцией с классом объекта.

В особенности следует избегать протечки теста в трейн/валид, т.к. приведет к завышенной оценке обобщающей способности выбранной в итоге модели. Но и протечка валида в трейн нехороша, т.к. приводит к выбору неоптимальных гиперпараметров.

## Работа с бенчмарками
Распространяемые датасеты зачастую содержат только 2 выборки, обычно называемые train и test или train и valid. 

Как их разбить на 3 выборки?
1. разбиваете train на трейн и валид и используете трейн для обучения, валид для выбора оптимальных значений гиперпараметров;
2. с выбранными оптимальными значениями гиперпараметров проводите обучени на полном train;
3. в качестве теста используете test/valid.

Если у вас особо много вычислительных ресурсов, в п. 1 можно сделать кроссвалидацию.

